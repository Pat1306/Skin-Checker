<!DOCTYPE html>
<html lang="th">   
<head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">  
     <title>Skin Checker</title>
     
     <style>
         body {
         
             margin: 0;
             font-family: "Segoe UI", sans-serif;
             background: #f5f7fb;
         }
         .container {
             max-width: 1100px;
             margin: auto;
             padding: 30px;
         }

         h1 {
             text-align: center;
             color: #1e88e5;
             margin-bottom: 30px;
         }

         .main{
             display:flex;
             gap:30px;
             margin-top:30px;
         }

/* ===== ‡∏ã‡πâ‡∏≤‡∏¢ ===== */
         .preview-box{
              flex:1.3;
              background:#fff;
              border-radius:16px;
              padding:20px;
              box-shadow:0 10px 30px rgba(0,0,0,0.1);
         }
         .box-title{
             color:#1e88e5;
             font-weight:bold;
             margin-bottom:10px;
         }
         .image-area{
             border:2px dashed #42a5f5;
             border-radius:12px;
             height:350px;
             display:flex;
             align-items:center;
             justify-content:center;
             position:relative;
             margin-bottom:15px;
         }
         .image-area img{
             max-width:100%;
             max-height:100%;
             object-fit:contain;
             display:none;
         }
         .image-area span{
             color:#1e88e5;
         }
         .change-btn{
             display:block;
             text-align:center;
             border:2px solid #f44336;
             color:#f44336;
             padding:10px;
             border-radius:8px;
             cursor:pointer;
             margin-bottom:15px;
  
         }
         .change-btn input{
             display:none;
         }
         .analyze-btn{
             width:100%;
             padding:14px;
             border-radius:30px;
             border:none;
             background:linear-gradient(135deg,#42a5f5,#00e5ff);
             color:#fff;
             font-size:16px;
             cursor:pointer;
         }

/* ===== ‡∏Ç‡∏ß‡∏≤ ===== */
         .result-box{
             flex:0.7;
             background:#fff;
             border-radius:16px;
             padding:20px;
             box-shadow:0 10px 30px rgba(0,0,0,0.1);
         }
             #resultTable{
             width:100%;
             border-collapse:collapse;
             display:none;
         }
        #resultTable th,#resultTable td{
              padding:8px;
              border-bottom:1px solid #ddd;
              text-align:left;
         }
         .note{
              margin-top:15px;
              color:#f44336;
             font-size:13px;
         }
         .ai-btn{
             width:100%;
             padding:14px 24px;
             border-radius:10px;
             border:none;
             font-size:16px;
             font-weight:600;
             color:#fff;
             cursor:pointer;
             background:linear-gradient(90deg,#2f6bff,#00e5ff);
             box-shadow:
                 0 4px 12px rgba(47,107,255,0.35),
                 inset 0 0 0 rgba(255,255,255,0);
             transition:all .25s ease;
         }

         .ai-btn:hover{
             transform:translateY(-1px);
             box-shadow:
                 0 8px 20px rgba(47,107,255,0.45),
                 inset 0 0 10px rgba(255,255,255,0.15);
         }

         .ai-btn:active{
             transform:scale(.98);
         }

         .ai-btn:disabled{
             background:#bdbdbd;
             box-shadow:none;
             cursor:not-allowed;
         }
         .ai-btn::after{
             content:"";
             position:absolute;
             right:0;
             top:0;
             width:40%;
             height:100%;
             background:rgba(255,255,255,0.15);
             filter:blur(10px);
         }
         /* ===== Loading Screen ===== */
         #loading{
             position:fixed;
             top:0;
             left:0;
             width:100%;
             height:100%;
             background:rgba(255,255,255,0.85);
             display:none;
             align-items:center;
             justify-content:center;
             z-index:9999;
         }

         .loading-box{
             text-align:center;
             background:#fff;
             padding:30px 40px;
             border-radius:16px;
             box-shadow:0 10px 30px rgba(0,0,0,.15);
         }

         .spinner{
             width:50px;
             height:50px;
             border:5px solid #e3f2fd;
             border-top:5px solid #1e88e5;
             border-radius:50%;
             animation:spin 1s linear infinite;
             margin:0 auto 15px;
         }

         @keyframes spin{
             100%{ transform:rotate(360deg); }
}


/* ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
         @media(max-width:768px){
             .main{flex-direction:column;}
         } 
</style>
</head>


<body>
    <!-- Loading Overlay -->
<div id="loading">
  <div class="loading-box">
    <div class="spinner"></div>
    <p>üß† AI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...</p>
  </div>
</div>

<div class="container">
  <h1>üß† Skin Checker</h1>

  <div class="main">

    <!-- ‡∏ã‡πâ‡∏≤‡∏¢ -->
    <div class="preview-box">
      <div class="box-title">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ</div>

      <div class="image-area">
        <img id="preview">
        <span id="previewText">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</span>
      </div>

      <label class="change-btn">
        ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ
        <input type="file" id="imageInput" accept="image/*" onchange="loadImage(event)">
      </label>

      <button class="ai-btn" onclick="predict()">Analyze</button>
    </div>

    <!-- ‡∏Ç‡∏ß‡∏≤ -->
    <div class="result-box">
      <div class="box-title">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</div>

      <table id="resultTable">
        <tr>
          <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
          <th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô (%)</th>
        </tr>
      </table>

      <div class="note">
        * ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÅ‡∏ó‡∏ô‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÑ‡∏î‡πâ
      </div>
    </div>

  </div>
</div>


<script>
function showLoading(show){
  document.getElementById("loading").style.display =
    show ? "flex" : "none";
}

function loadImage(event) {
  const img = document.getElementById("preview");
  const text = document.getElementById("previewText");
  img.src = URL.createObjectURL(event.target.files[0]);
  img.style.display = "block";
  text.style.display = "none";
}

async function predict() {
  const fileInput = document.getElementById("imageInput");
  const btn = document.querySelector(".ai-btn");
  const file = fileInput.files[0];

  if (!file) {
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ");
    return;
  }

  btn.disabled = true;      // üîí ‡∏•‡πá‡∏≠‡∏Å‡∏õ‡∏∏‡πà‡∏°
  showLoading(true);        // üî• ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏´‡∏•‡∏î

  try {
    const base64 = await toBase64(file);

    const response = await fetch(
      "https://serverless.roboflow.com/my-first-project-jpfoo/1?api_key=9j2JhaUCP9GD3ZUE5yOc",
      {
        method: "POST",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded"
        },
        body: base64
      }
    );

    const result = await response.json();
    console.log(result);

    const table = document.getElementById("resultTable");
    table.style.display = "table";
    table.innerHTML = `
      <tr>
        <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
        <th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô (%)</th>
      </tr>
    `;

    if (!result.predictions || result.predictions.length === 0) {
      const row = table.insertRow();
      row.insertCell(0).innerText = "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå";
      row.insertCell(1).innerText = "-";
    } else {
      result.predictions.forEach(p => {
        const row = table.insertRow();
        row.insertCell(0).innerText = p.class;
        row.insertCell(1).innerText =
          (p.confidence * 100).toFixed(2);
      });
    }

  } catch (err) {
    alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå");
    console.error(err);
  }

  showLoading(false);   // üî• ‡∏ã‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏´‡∏•‡∏î
  btn.disabled = false; // üîì ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏õ‡∏∏‡πà‡∏°
}

function toBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () =>
      resolve(reader.result.split(",")[1]);
    reader.onerror = error => reject(error);
  });
}
</script>
</body>
</html>